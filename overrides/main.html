{% extends "base.html" %}

{% block content %}
  {% if page and page.is_homepage %}
    <style>
      /* Убираем отступ у .md-main__inner */
      .md-main__inner {
        margin-top: 0 !important;
        padding-top: 0 !important;
      }

      .md-content__inner {
        margin-top: 0 !important;
        padding-top: 0 !important;
      }

      .md-content__inner::before {
        display: none !important;
      }

      .md-content__inner > article {
        margin-top: 0 !important;
      }

      .md-typeset {
        margin-top: 0 !important;
      }

      /* Убираем боковые панели на планшетах и десктопах */
      @media screen and (min-width: 48em) {
        .md-sidebar--primary,
        .md-sidebar--secondary {
          display: none !important;
        }
      }

      .md-content {
        margin-left: 0 !important;
        margin-right: 0 !important;
        max-width: 100% !important;
      }

      /* Скрываем все остальные элементы на главной */
      .md-content__inner > *:not(.landing):not(.sections):not(.about) {
        display: none !important;
      }

      /* Убираем лишние стили у h2 от темы */
      .md-typeset h2 {
        margin: 0 !important;
        line-height: inherit !important;
      }

      /* Плавный скролл */
      html {
        scroll-behavior: smooth;
      }

      @media screen and (max-width: 76.1875em) {
        .md-main__inner {
          padding: 0 !important;
        }
      }
    </style>

    <!-- Лендинг-блок -->
    <div class="landing">
      <section class="hero">
        <h1>Ласкаво просимо до My Docs</h1>
        <p class="subtitle">
          Це моя особиста документація по Linux, Windows та іншим темам.<br>
          Тут зібрані нотатки, інструкції та корисні поради.
        </p>
        <div class="arrow-container">
          <a href="#sections" class="arrow-link">
            <div class="arrow-circle">
              <div class="arrow-down"></div>
            </div>
          </a>
        </div>
      </section>
    </div>

    <!-- Блок с разделами -->
    <section class="sections dotted-section" id="sections">
      <div class="container">
        <h2>Розділи</h2>
        <div class="cards">
          <a href="https://silmarill07.github.io/my-docs/Linux/Alials.html" class="card">
            <div class="img-container">
              <img src="assets/images/linux.png" alt="Linux">
            </div>
            <p>аліаси та налаштування</p>
          </a>

          <a href="https://silmarill07.github.io/my-docs/Windows/%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0-MS-Edge.html" class="card">
            <div class="img-container">
              <img src="assets/images/windows.png" alt="Windows">
            </div>
            <p>налаштування та оптимізація</p>
          </a>

          <a href="https://silmarill07.github.io/my-docs/Other/Service-Worker.html" class="card">
            <div class="img-container">
              <img src="assets/images/other.png" alt="Other">
            </div>
            <p>різні корисні матеріали</p>
          </a>

          <a href="https://silmarill07.github.io/my-docs/tags.html" class="card">
            <div class="img-container">
              <img src="assets/images/tags.png" alt="Tags">
            </div>
            <p>швидкий пошук по темах</p>
          </a>
        </div>
      </div>
    </section>

    <!-- Блок "Про проект" -->
    <section class="about dotted-section">
      <div class="container">
        <h2>Про проект</h2>
        <p>
          Цей сайт створений на основі <strong><a href="https://squidfunk.github.io/mkdocs-material/" target="_blank">MkDocs Material</a></strong>
        </p>
        <div class="tip-center">
          <div class="admonition tip">
            <p class="admonition-title">Підказка</p>
            <p>
              Використовуй меню зверху або посилання на цій сторінці, щоб швидко перейти до потрібного розділу.
            </p>
          </div>
        </div>
      </div>
    </section>

  {% else %}
    {{ super() }}
  {% endif %}
{% endblock %}

{% block scripts %}
  {{ super() }}
  <script>
    (function() {
      // --- 1. Динамический расчет высоты hero ---
      const hero = document.querySelector('.landing .hero');
      const main = document.querySelector('.md-main');

      if (hero && main) {
        const setHeroHeight = () => {
          const vh = window.innerHeight;
          const mainTop = main.getBoundingClientRect().top;
          if (mainTop > 0) {
            hero.style.height = `${vh - mainTop}px`;
          }
        };
        window.addEventListener('load', () => setTimeout(setHeroHeight, 200));
        window.addEventListener('resize', setHeroHeight);
      }

      // --- 2. Ручной скролл для стрелки ---
      document.body.addEventListener('click', function(event) {
        const arrowLink = event.target.closest('.arrow-link');
        if (!arrowLink) {
          return;
        }

        event.preventDefault();
        event.stopImmediatePropagation();

        const targetId = arrowLink.hash;
        if (!targetId) return;

        const targetElement = document.querySelector(targetId);

        if (targetElement) {
          const header = document.querySelector('.md-header');
          const headerHeight = header ? header.offsetHeight : 0;
          const offset = 20; // Отступ

          const targetPosition = targetElement.getBoundingClientRect().top + window.pageYOffset - headerHeight + offset;

          window.scrollTo({
            top: targetPosition,
            behavior: 'smooth'
          });
        }
      }, true);

    })();
  </script>
{% endblock %}